---
title: "Make Convenient Inputs for Gavi MenA Models"
author: "Chris Stewart"
date: "November 21, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

read files
```{r }
#directory containing inputs
setwd("\\\\HOME/stewcc1/MenAModel/data/GAVI inputs")
#country-specific parameters
tmpb<-read.csv("201708test-1_unwpp_2017_births.csv")
tmpdr<-read.csv("201708test-1_unwpp_2017_cdr.csv")
tmppop<-read.csv("201708test-1_unwpp_2017_tot_pop.csv")
tmpimr<-read.csv("201708test-1_unwpp_2017_unwpp_imr.csv")
```

only totalpop goes to 2100, copy the 2099 values as 2100 for the others
```{r }
newb<-tmpb[tmpb$year==2099,]
newb$year=2100;
allb=rbind(tmpb, newb)
newdr<-tmpdr[tmpdr$year==2099,]
newdr$year=2100;
alldr=rbind(tmpdr, newdr)
newimr<-tmpimr[tmpimr$year==2099,]
newimr$year=2100;
allimr=rbind(tmpimr, newimr)
```

rename value columns, then merge the four dataframes into one with four variables
```{r }
colnames(allb)[colnames(allb)=="value"] <- "births"
colnames(alldr)[colnames(alldr)=="value"] <- "deathrate"
colnames(tmppop)[colnames(tmppop)=="value"] <- "totalpop"
colnames(allimr)[colnames(allimr)=="value"] <- "imr"
merge1<-merge(x=tmppop, y=allb, by=c("country", "year", "gender"), all=TRUE)
merge1$birthrate=merge1$births/merge1$totalpop
merge2<-merge(x=merge1[c("country", "year", "gender", "totalpop", "births", "birthrate")], y=alldr, by=c("country", "year", "gender"), all=TRUE)
merge3<-merge(x=merge2[c("country", "year", "gender", "totalpop", "births", "birthrate")], y=allimr, by=c("country", "year", "gender"), all=TRUE)
```

write a csv
```{r }
outfile<-paste0("\\\\HOME/stewcc1/MenAModel/data/ModelInputs/country_params.csv")
write.csv(merge3,outfile)
```

